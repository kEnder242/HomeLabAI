# BKM Retrospective: The "Triage Patch" Snafu & Surgical Recovery
**Date:** Feb 15, 2026
**Topic:** Failure of full-file overwrites and restoration of high-fidelity logic.
**Status:** RECOVERY IN PROGRESS

## üèéÔ∏è 1. Preparation (One-Liner)
`git checkout -b debug-recovery-snafu && git log --grep="Final Milestone" --oneline`

## üß™ 2. Core Logic (The Delta)
The "Triage Patch" was a full-file overwrite used to satisfy strict lint-gates, which accidentally stubbed out complex logic.

### **The "Real" Fixes (Validated Discoveries):**
- **Handshake Robustness**: Defensive parsing for `list_cabinet` in `acme_lab.py`.
- **Absolute Imports**: `from nodes.loader import BicameralNode` in node scripts.
- **Schema Alignment**: `deep_think` argument must be `task` in `brain_node.py`.
- **Graceful Shutdown**: Intercepting `shutdown` status and explicitly closing `exit_stack`.
- **Environment Hardening**: Explicit `PYTHONPATH` for sub-process environment.
- **UI Refinement**: CSS-based timestamps and labels (removing `[ME]`, `[SYSTEM]`).
- **Workspace Scaling**: Calling `.refresh()` on EasyMDE during resize events.

### **The "Fake" Fixes (Patch Side-Effects):**
- **EarNode Stubbing**: Replacing NeMo logic with `None` returns.
- **Triage Flattening**: Hardcoded Brain priority instead of nuanced Pinky delegation.
- **Tool Omission**: Forgetting `list_cabinet` and `close_lab` in node rewrites.

## ü§ï 3. Scars (Known Failures)
- **Failure:** Full-file overwrites (`write_file`) are "Nuclear Options" that destroy un-read high-fidelity features.
- **Mitigation:** ALL future edits must use `scalpel.py` or `atomic_patcher.py` with granular search/replace blocks.
- **Failure:** Relative imports in nodes fail when run as standalone sub-processes.
- **Mitigation:** Standardize on absolute imports for all Bicameral residents.

## üéØ 4. The Recovery Plan
1. **Hard Revert**: Identify the "Golden" commit (pre-snafu, likely `ff113ce`).
2. **Hard Revert**: Revert `acme_lab.py`, `brain_node.py`, `pinky_node.py`, and `archive_node.py`.
3. **Surgical Delta**: Use Safe Scalpel to apply only the 7 "Real Fixes" above.
4. **Validation**: Run `test_lifecycle_gauntlet.py` and verify Full-Stack co-pilot.

---
*Generated by the Lead Engineer's Thought Partner*
